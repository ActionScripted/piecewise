#####################################
# 1. PIECEWISE SYSTEM CONFIGURATION #
#####################################
#
# In this section you will update variables that configure the Piecewise application
# for the remote VM or server.
# 
# Required fields are indicated with the text "# !REQUIRED!" just below the variable name.
# If a field is marked Required, you must enter a value or change the default value.

env: development
# !REQUIRED!
#
# env   Instructs Ansible whether this is a server/VM in development or in production.
#
#       Supported values: production, development
#
#       Use development if you only have an IP address for your server/VM.
#       Use production if you have configured DNS to provide a domain name for your server/VM.

project_name: piecewise
# #DEFAULT#
#
# project_name  
#       The name of your forked repository. This is likely 'piecewise', unless you have renamed
#       the repository after forking it from https://github.com/opentechinsstute.org/piecewise
# TO DO: may no longer be needed. confirm.
#

remote: https://github.com/schelcj
# !REQUIRED!
#
# remote  
#       The URL where your repository is available. You can use any valid git remote. 
#       For example: https://github.com/opentechinstitute 
# TO DO: may no longer be needed. confirm.

piecewise_commit: mi_moonshot
# !REQUIRED!
#
# piecewise_commit
#       Specify any ref (eg. branch, tag, SHA) to be deployed. This ref must be
#       pushed to the remote git_repo before it can be deployed.
# TO DO: may no longer be needed. confirm.

git_repo: "{{ remote }}/{{ project_name }}.git"
# TO DO: may no longer be needed. confirm.

bigquery_project_num: mlab-piecewise
# !REQUIRED!
#
# bigquery_project_num
#       The BigQuery Project Number or Project Name from your project details in the
#       Google Cloud Console at https://console.cloud.google.com
#       This can be the numeric project number or the project name text.

database_name: piecewise
database_user: postgres
database_user_group: postgres
# #DEFAULT#
#
#       These variables define the Postgres database name, user and system group for  
#       the database user. These can be safely left as the default, unless you desire to 
#       change them.

site_fqdn: mi.broadbandtest.us
# !REQUIRED!
#
# site_fqdn 
#       FQDN stands for Fully Qualified Domain Name. 
#       This value should contain either:
#       - the domain name of your production server, ie: www.mywebsite.com
#       - the IP address of your development or production server, ie: 111.222.333.444
#
#       Use an IP address for development, either on a server/VM on our LAN or a 
#       development server/VM on a cloud service like Linode, GCE, Amazon, etc. 
#
#       Once you have the server's domain name in DNS working, you can use it instead of the IP address.

#-------------------------------------------->>

########################
# 1.1 SSL CERTIFICATES #
########################
# The variables in this section will be used to generate SSL certificates. When 
# deploying to development hosts, the country, state and city are used by openssl to
# generate a self-signed certificate. This is useful when you don't have an DNS name
# set up yet and want to deploy using the host's IP address, or to a server not
# accessible to the Internet.
#

site_contact: mimoonshotprojectteam@merit.edu
site_country: US
site_state: Michigan
site_city: Ann Arbor
site_ou: Merit Network, inc.
# !REQUIRED!
#
# site_contact    These variables are provided to enable automatic generation of 
#     _country    SSL certificates, either self-signed for development hosts or
#     ...         valid certificates through the Let's Encrypt CA for production hosts.

self_signed_ssl_cert_path: /etc/ssl/certs/selfsigned.{{ site_fqdn }}.cert
self_signed_ssl_key_path: /etc/ssl/private/selfsigned.{{ site_fqdn }}.key
# #DEFAULT#
#
# When env = 'development', these variables set the directory on the 
# server/VM where self-signed SSL certificates will be saved. 
# In most cases you will not need to change these values from the default.

letsencrypt_ssl_cert_path: /etc/letsencrypt/live/{{ site_fqdn }}/fullchain.pem
letsencrypt_ssl_key_path: /etc/letsencrypt/live/{{ site_fqdn }}/privkey.pem
# #DEFAULT#
#
# When env = 'production', these variables set the directory on the 
# server/VM where Let's Encrypt SSL certificates will be saved.
# In most cases you will not need to change these values from the default.

#################################
# 1.2 DEPLOYMENT FILE LOCATIONS #
#################################
# The variables in this section determine where specific components will be deployed on
# the remote sytem. These can be largely unchanged, unless your system requires 
# different paths.

base_path: /opt
# #DEFAULT#
#
# Where the base files from your repo will be copied on the remote server.

temp_path: "{{ base_path }}/tmp"
# #DEFAULT#
#
# Temporary location on the remote server where files may be extracted temporarily.
# TO DO: may no longer be needed. confirm.

site_path: "{{ base_path }}/piecewise_web"
# #DEFAULT#
#
# Where the website files should be on the server.

#-------------------------------------------->>

###########################################
# 2. MAPPING & AGGREGATION CUSTOMIZATIONS #
###########################################
# The variables in this section define the geographic information needed by the Piecwise
# server backend. They also define the regions to use to calculate aggregate statistics
# for M-Lab data submitted.

########################################
# 2.1 Geodata and Database Information #
########################################
# The section below defines variables used to import your geodata into the database.
# 
# The values you set here assume you have located shapefiles for your region.
# You will need the filenames and knowledge of the field names and datatypes in the
# shapefiles for these variables.
#
# Save the geofiles you intend to use for your Piecewise aggregations of
# M-Lab data in the folder: /local_customizations/geofiles/

shape_file: cb_2017_26_bg_500k.shp

# !REQUIRED!
#
# shape_file  The filename of the shapefile Piecewise should use for your aggregations.

dbKey: geoid
dbKeyDataType: string
shape_projection: "EPSG:4326"
geometry_type: MultiPolygon
layer_name: mi_house_districts
aggregation_name: "mi_house_districts"
aggregation_stats_table_name: "mi_house_districts_stats"

### Geolayers - change from single layer to multiple geolayer support using yaml struct
#               similar to how the form fields are constructed.

geolayers:
  1:
    shape_file: cb_2015_53_bg_500k.shp
    dbKey: geoid
    dbKeyDataType: string
    shape_projection: "EPSG:4326"
    geometry_type: MultiPolygon
    layer_name: mi_house_districts
    aggregation_name: "mi_house_districts"
    aggregation_stats_table_name: "mi_house_districts_stats"
    topojson_file: mi_censusblocks.topojson
    geoKey: GEOID
    mapscript_layer_name: "mi_house"
    mapscript_layer_name_pretty: "Michigan State House Districts"
    mapscript_json_type: "topojson"

asn_map:
  1:
    Merit: "AS237 Merit Network, inc."

# !REQUIRED!
#
# dbKey             The field name of the unique key in your shape file.
# dbKeyDataType     The data type of dbKey.
# shape_projection  The SRS reprojection/transform to use for this shapefile.
# geometry_type     The geometry type for this layer
# layer_name        The name you wish to be used for this shapefile layer in postgres.
# aggregation_name  The name you wish to use to name this aggregation
# aggregation_stats_table_name    The table name to use for aggregate statistics.

##############################################
# 2.2 Geographic Coordinates and Date Ranges #
##############################################
# Variables in this section define the geographic area and date range you would
# like to use in this Piecewise server. 
map_coordinate_southwest:
  lat: 41.61
  lon: -90.47

map_coordinate_northeast:
  lat: 47.59
  lon: -82.34

# The coordinates above define the latitude and longitude for the southwest and 
# northeast corners of a bounding box, defining the region from which you are 
# interested in pulling M-Lab NDT data.
#
# These four variables are used to format the variable map_bounding_box below. 
map_bounding_box: "{{ map_coordinate_southwest.lon }},{{ map_coordinate_southwest.lat }},{{ map_coordinate_northeast.lon }},{{ map_coordinate_northeast.lat }}"
# You do not need to edit the value for map_bounding_box.

map_data_start_date: "Jan 1 2018 00:00:00"
map_data_end_date: "Dec 31 2055 00:00:00"
# !REQUIRED!
#
# map_data_start_date   The range of dates for your server to get M-Lab NDT test data.
# map_data_end_date
#
# During development, we usually set a smaller date range to enable faster ingesting
# of M-Lab data to test the application.
#
# For a production server, it is advisable to set 'map_data_data_end_date'
# to a date well in the future, for example: "Dec 31 2050 00:00:00".

#-------------------------------------------->>

############################
# 3. WEBSITE CUSTOMIZATION #
############################
# The section below defines variables to be used on the website.

######################################
# 3.1 Website Geographic Information #
######################################

topojson_file: mi_censusblocks.topojson
# !REQUIRED!
#
# topojson_file   The file name of a topojson format geo file that is 
#                 - created using the shapefile defined above
#                 - saved in the folder /local_customizations/geofiles/ 

geoKey: GEOID
# !REQUIRED!
#
# geoKey    The field name in your topojson file which corresponds to the unique key 
#           in your shapefile. 
#           This is typically the same as dbKey, but in CAPITAL LETTERS.

mapscript_layer_name: "mi_house"
mapscript_layer_name_pretty: "Michigan State House Districts"
# !REQUIRED!
#
# These variables name the map layers on the website. 'mapscript_layer_name' is used as 
# a layer name in the JavaScript code, and 'mapscript_layer_name_pretty' is used in the 
# UI if the layer controls are displayed for the user.

mapscript_json_type: "topojson"
# # DEFAULT #
#
# In the future, support for other types of geodata, such as the geojson format may be
# included in Piecewise. Currently, the mapscript json type should always be 'topojson'. 

mapscript_start_year: 2019
mapscript_start_month: 1
# # DEFAULT #
#
# mapscript_start_year  The first year that should be displayed in the 'year' dropdown.
# mapscript_start_month Define the start month in the timeline.

mapscript_base_layer: osm
# # DEFAULT #
#
# mapscript_base_layer  Defines the type of base layer to be used on the map.
#                       Either Mapbox.com or OpenStreetMaps base layers are supported. 
#                       Set mapscript_base_layer to either: 'mapbox' OR 'osm'

mapscript_osm_api_url: "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
mapscript_mapbox_api_url: ""
# # DEFAULT #
#
# If you would like to customize the OSM base layer API url, for example if you
# are hosting custom maps and tiles on your own tile server, update mapscript_osm_api_url.
# The default OSM url is provided.

# If you are using a Mapbox base layer, set the API URL for your Mapbox tiles above.

mapscript_min_data_points: 25
# # DEFAULT #
#
# Sets the minimum number of tests which must be present in any aggregate area defined by
# your shapefile in order to be displayed on the aggregate website map.

mapscript_zoom_level: 8
# # DEFAULT #
#
# Sets the initial zoom level for the map display.

# This dictionary of month names/abbreviations lets you configure how month names appear 
# on the website map controls. 
# # DEFAULT #
mapscript_month_names: 
  1: 2019
#   1: 2018
#   2: 2017
#   3: 2016
#   4: 2015
#   5: 2014
#   6: 2013
#   7: 2012
#   8: 2011
#   9: 2010
#   10: 2009

####################
# 3.2 Website Form #
####################
# The section below allows you to customize the HTML form preceding the test.
# These values are used to create the HTML form on the webpage, and to set up the
# fields in a database table where submissions are stored. 

# Select lists and text fields are the only types of HTML form elements 
# currently supported. For each type of field, all values are required to be present.
# For example the field definition below is missing db_type and is incorrect:
#    5:
#     advertised_download:
#        field_type: text
#        name: advertised_download
#        id: advertised_download
#        text: "What is your advertised download speed?"
#        size: 3
#        required: no

# Each form field is defined by a nested YAML dictionary structure. 
# Use the structure provided, and change only the values. For example:
#
#  1:
#    isp_user:
#      field_type: select_list
#      db_type: String
#      name: isp_user
#      id: isp_user
#      text: "Select your ISP"
#      options:
#        1:
#          default: "------"
#        2:
#          verizon: "Verizon"
#        3:
#          att: "AT&amp;T"
#        4:
#          comcast: "Comcast"
#        5:
#          tmobile: "T-Mobile"
#        6:
#          other: "Other"
#     required: yes
# 

# Fields are rendered in the order they appear here. Use the first numeric index
# after 'form_fields:' to arrange the order of fields. For example, to reverse the
# display of download and upload speed fields:
# 
# form_fields:
#   ... 
#   5:
#     advertised_upload:
#     ...
#   6:
#     advertised_download:

form_fields:
  1:
    test_location:
      field_type: select_list
      page: 1
      db_type: String
      name: test_loc
      id: test_loc
      text: "Where are you completing this survey from?"
      options:
        a_default: "------"
        b_home: "Home"
        c_school: "School"
        d_library: "Library"
        e_work: "Work"
        f_other: "Other location"
  2:
    household_num:
      field_type: select_list
      db_type: String
      page: 1
      name: household_num
      id: household_num
      text: "Including yourself, how many people live in your home?"
      options:
        a_default: "------"
        b_one: "1"
        c_two: "2"
        d_three: "3"
        e_four: "4"
        f_five: "5"
        g_six: "6"
        h_seven: "7"
        i_eight: "8"
        j_nine: "9"
        k_nineplus: "9+"
  3:
    household_minor_num:
      field_type: select_list
      db_type: String
      page: 1
      name: household_minor_num
      id: household_minor_num
      text: "Including yourself, how many of those living in your home are under the age of 18?"
      options:
        a_default: "------"
        b_1: "1"
        c_2: "2"
        d_3: "3"
        e_4: "4"
        f_5: "5"
        g_6: "6"
        h_7: "7"
        i_8: "8"
        j_9: "9"
        k_10: "9+"
  4:
    home_owner:
      field_type: select_list
      page: 1
      db_type: String
      name: home_owner
      id: home_owner
      text: "Does your family own or rent the place where you live?"
      options:
        a_default: "------"
        b_yes: "Own"
        c_no: "Rent"
        d_unknown: "Don't know"
## TODO - change when question list is updated.
  5:
    paid_subscription:
      field_type: select_list
      page: 1
      db_type: String
      name: paid_subscription
      id: paid_subscription
      text: "Does anyone in your home pay a cable company, phone company, or another internet service provider to provide internet service for your home?"
      options:
        a_default: "------"
        b_yes: "Yes"
        c_no: "No"
  6:
    service_type:
      field_type: select_list
      page: 1
      db_type: String
      name: service_type
      id: service_type
      text: "To the best of your knowledge, what type of internet service is at your home?"
      options:
        a_default: "------"
        b_dsl_cable_fiber: "DSL, cable, or fiber optic service"
        c_satellite: "Satellite"
        d_mobile: "Mobile data plan or cellular hotspot"
        e_fixed_wireless: "Fixed wireless"
        f_shared_wifi: "Share neighbors wifi"
        g_no_access: "I don't have internet access at home"
        h_unknown: "Don't know"
## TODO - does piecewise support checkboxes?
  7:
    home_usage_problems:
      field_type: select_list
      page: 1
      db_type: String
      name: home_usage_problems
      id: home_usage_problems
      text: "Do you have problems using the internet at home to do any of the following? (Check any that apply)"
      options:
        default: "------"
        homework: "Homework (if applicable)"
        uploading: "Uploading / sharing video"
        streaming: "Watching / streaming video"
        gaming: "Gaming"
  8:
    service_cost:
      field_type: select_list
      page: 1
      db_type: String
      name: service_cost
      id: service_cost
      text: "How much does your home internet service cost per month?"
      options:
        a_default: "------"
        b_<_10: "Less than $10"
        c_10_25: "$10 - $25"
        d_26_50: "$26 - $50"
        e_51_75: "$51 - $75"
        f_76_100: "$76 - $100"
        g_101_150: "$101 - $150"
        h_>_151: "More than $151"
        i_no_service: "We do not have home subscription"
  9:
    service_bundle:
      field_type: select_list
      page: 1
      db_type: String
      name: service_bundle
      id: service_bundle
      text: "If you know, is your home Internet access bundled with other services (check any that apply)"
      options:
        a_default: "------"
        b_no_bundle: "Not bundled"
        c_cable_sat: "Cable or satellite TV"
        d_home_phone: "Home phone"
        e_cell_phone: "Cell phone"
        f_home_security: "Home security"
        g_unknown: "Don't know"
  10:
    survey_wifi:
      field_type: select_list
      page: 1
      db_type: String
      name: survey_wifi
      id: survey_wifi
      text: "Are you currently using Wi-Fi to complete this survey?"
      options:
        a_default: "------"
        b_yes: "Yes"
        c_no: "No"
        d_unknown: "Don't know"
  11:
    service_satisfaction:
      field_type: select_list
      page: 1
      db_type: String
      name: service_satisfaction
      id: service_satisfaction
      text: "On a scale of 1-5 (5 being most satisfied) - how satisfied are you with your home Internet service?"
      options:
        a_default: "------"
        b_no_service: "Do not have home internet service"
        c_very_dissatisfied: "Very dissatisfied"
        d_dissatisfied: "Dissatisfied"
        e_neutral: "Neutral"
        f_satisfied: "Satisfied"
        g_very_satisfied: "Very satisfied"
  12:
    survey_uid_username:
      field_type: text
      page: 1
      db_type: String
      name: survey_uid_username
      id: survey_uid_username
      text: "School ID or username"
      required: yes
  13:
    survey_address:
      field_type: text
      page: 1
      db_type: String
      name: survey_address
      id: survey_address
      text: "Street Address (optional)"
      size: 3
      required: no
  14:
    survey_email_address:
      field_type: text
      page: 1
      db_type: String
      name: survey_email_address
      id: survey_email_address
      text: "Email Address(optional)"
      size: 1
      required: no
  15:
    education_level:
      field_type: select_list
      page: 1
      db_type: String
      name: education_level
      id: education_level
      text: "If you know, and are willing to share - what is the highest level of education of any adult in your home? (optional)"
      required: no
      options:
        a_default: "------"
        b_high_school_incomplete: "High school incomplete"
        c_completed_12_or_GED: "Completed grade 12 or GED"
        d_tech_trade_voc: "Technical, trade or vocational school AFTER high school"
        e_some_college: "Some college, no 4-year degree (includes associate degree)"
        f_college_grad: "College graduate (B.S., B.A., or other 4-year degree)"
        g_post_grad: "Post-graduate training (toward a Masters/Ph.D., Law or Medical school)"
  16:
    household_income:
      field_type: select_list
      page: 1
      db_type: String
      name: household_income
      id: household_income
      text: "If you know, and are willing to share - Last year (2018) what was your total household income from all sources, before taxes? (optional)"
      required: no
      options:
        a_default: "------"
        b_<_10K: "Less than $10,000"
        c_10K_20K: "$10,000 to under $20,000"
        d_20K_30K: "$20,000 to under $30,000"
        e_30K_40K: "$30,000 to under $40,000"
        f_40K_50K: "$40,000 to under $50,000"
        g_50K_75K: "$50,000 to under $75,000"
        h_75K_100K: "$75,000 to under $100,000"
        i_100K_150K: "$100,000 to under $150,000"
        j_>_150K: "$150,000 or more"

####################
# 3.3 Website Text #
####################
# The section below allows you to customize various text and other elements of the website.

site_name: "Citizen Enabled Advances in Broadband Availability Data"
# #DEFAULT#
#
# Defines the HTML page title element

intro_text: >
  At least 381,000 households in Michigan do not
  have access to broadband – primarily because
  low returns on investment in rural areas are not
  conducive to for-profit deployment.  Educators
  have been talking about the “digital divide”
  for two decades, and while some progress has been
  made in closing the gap, inequities persist in
  communities across the country.  In 2009, the
  Federal Communication Commission’s Broadband
  Task Force reported that approximately 70% of
  teachers assign homework requiring access to
  broadband - what does this mean for the 5 million
  households with school-age children that do not
  have high-speed Internet service at home?  A
  consistent challenge nationally is understanding
  where and what speeds and attributes broadband is
  currently available.

instructions_text: >
  The Measurement Lab (M-Lab) platform is run by the scientific community.
  We make all test results publicly available via the MeasurementLab.net website 
  to help promote Internet research. M-Lab's Network Diagnostic Tool collects a number 
  of measures of different facets of your Internet connection. The information published
  includes each device’s IP address, but does not include personal identifying information
  about you as an Internet user.

# #DEFAULT#
#
# Defines the heading text that precedes the HTML survey form, provided to users
# before they may take the test.

consent_message: >
  I agree to the <a href="http://www.measurementlab.net/privacy/">M-Lab privacy policy</a>,
  which includes retention and publication of IP addresses, in addition to speed test results.
# #DEFAULT#
#
# Defines the message displayed next to the consent checkbox.

# The variables below define the messages and labels provided to the user before and 
# after the test.
run_test_heading: "Test your speed!"
test_result_heading: "Your test results"
download_result_label: "Download speed:"
download_result_unit: "Mbps"
upload_result_label: "Upload speed:"
upload_result_unit: "Mbps"
rtt_result_label: "Minimum Round Trip Time:"
rtt_result_unit: "ms"
thank_you_heading: "Thank you!"
thank_you_message: >
  Your test results will be combined with others and will appear on the map soon.
# #DEFAULT#
#

# 'next_action_' variables define the action items present to the user after they run the test.
next_action_message: "What do you want to do next?"
next_action_show_map_text: "View all results to-date on a map of Michigan"
next_action_learn_about_text: "Learn more about this test and how to improve your speed"
next_action_learn_about_link: "https://broadbandtest.us/"
# next_action_social_share_text: none
# #DEFAULT#
#

# 'social_share_' variables define the links to be used for social sharing actions.
#
# If you set any of these to 'none', they will be excluded from the website.
# If you don't want any social share options, set all of the items below to 'none'
# and also set 'next_action_social_share_text' to 'none' (without quotes) above.
social_share_twitter: "none"
social_share_gplus: "none" #"https://plus.google.com/share?url=http://www.seattle.gov/broadband-speed-test"
social_share_facebook: "none"
social_share_stumbleupon: "none" #"http://www.stumbleupon.com/submit?url=http://www.seattle.gov/broadband-speed-test&title=I%20tested%20my%20Internet%20speeds%20with%20the%20Seattle%20Broadband%20Speed%20Test"
social_share_reddit: "none" #"http://reddit.com/submit?url=http://www.seattle.gov/broadband-speed-test&title=I%20tested%20my%20Internet%20speeds%20with%20the%20Seattle%20Broadband%20Speed%20Test"
social_share_linkedin: "none" #"http://www.linkedin.com/shareArticle?url=http://www.seattle.gov/broadband-speed-test&title=I%20tested%20my%20Internet%20speeds%20with%20the%20Seattle%20Broadband%20Speed%20Test&summary=I%20tested%20my%20Internet%20speeds%20with%20the%20Seattle%20Broadband%20Speed%20Test&source=http://www.seattle.gov/broadband-speed-test"
social_share_email: "none" #"mailto:?subject=Take%20the%20Seattle%20Broadband%20Speed Test&body=I%20just%20took%20the%20Seattle%20Broadband%20Speed%20Test,%20and%20you%20should%20too!%20Take%20the%20test%20and%20contribute%20to%20a%20map%20of%20broadband%20speeds%20across%20the%20city. http://www.seattle.gov/broadband-speed-test"
# #DEFAULT#
#

# 'icon_' and 'mapview_icon_' variables define the text accompanying the icons in the user interface.
#
# 'icon_' variables set the text values and '?' link accompanying icons on the initial map display.
icon_test_label: "Take the Speed Test"
icon_test_alt_text: "Take the Speed Test"
icon_browse_label: "Browse the Broadband Map"
icon_browse_alt_text: "Browse the Broadband Map"
icon_learn_label: "Learn More"
icon_learn_alt_text: "Learn more about this test."
icon_learn_link: "https://broadbandtest.us/"
# #DEFAULT#
#

# 'mapview_icon_' variables set the text values and '?' link on the mapview display
mapview_icon_test_alt_text: "Take the Speed Test"
mapview_icon_learn_alt_text: "Learn more about this test."
mapview_icon_learn_link: "https://broadbandtest.us/"
# #DEFAULT#
#

# The two variables below control where Leaflet map controls are placed in the UI. 
# They should remain unchanged for now. More work on positioning for Leaflet elements will follow.
mapcontrols_zoom_pos: topright
mapcontrols_legend_pos: bottomleft
# #DEFAULT#
#
#-------------------------------------------->>
